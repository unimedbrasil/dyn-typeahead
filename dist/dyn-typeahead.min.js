!function(){"use strict";angular.module("dyn.typeahead",["ui.bootstrap"])}(),function(){"use strict";function e(){return{restrict:"E",templateUrl:"app/dyn-typeahead-template.html",controller:n,controllerAs:"dynTypeaheadCtrl",require:"ngModel",scope:{domain:"@",url:"@",localElements:"=",key:"@",value:"@",ngModel:"=",placeholder:"@",onSelect:"&",disabled:"=?ngDisabled"},link:function(e,n,t,l){l.$formatters.push(function(e){var n=!e||Number.isInteger(e);l.$setValidity("isNaN",n)})},bindToController:!0,replace:!1}}function n(e,n,t,l){function o(){a(),u()}function a(){l.$watch(function(){return p.localElements},function(){u(!0)}),l.$watch(function(){return p.ngModel},g)}function u(e){function t(e){p.values=e,p.loading=!1,g()}function l(e){var l=p.ngModel;n(function(){p.ngModel=null,n(function(){p.ngModel=l,t(e)},0)},0)}if(p.values.length>0&&!e)return p.values;if(p.loading=!0,p.domain)i().then(l);else if(p.url)c().then(l);else{if(!p.localElements)throw new Error("Um valor para domain, url ou localElements deve ser especificado.");t(angular.copy(p.localElements))}}function r(e){var n=p.values.filter(function(n){if(e){var t=(n[p.key]+"").toLowerCase(),l=(n[p.value]+"").toLowerCase(),o=e.toLowerCase();return t.indexOf(o)>=0||l.indexOf(o)>=0}return!0});return n}function i(){return t.getDomain(p.domain).then(function(e){return e})}function c(){return e.get(p.url).then(function(e){return e.data})}function d(){p.loading||(p.noResults=!1,p.ngModel="",p.onSelectValue(null,null,null))}function f(){p.loading||(p.focusTypeahead=!0)}function s(e){for(var n=0;n<p.values.length;n++){var t=p.values[n];if(String(e)===String(t[p.key]))return String(t[p.value])}return e}function v(e,n,t){if(p.onSelect){var l=p.onSelect();"function"==typeof l&&l(e)}}function g(){if(null!==p.ngModel&&void 0!==p.ngModel){var e=y(p.values,p.ngModel);return e?void p.onSelectValue(e,e[p.key],e[p.value]):p.ngModel}}function y(e,n){for(var t=0;t<e.length;t++){var l=e[t];if(n===l[p.key])return l}}var p=this;p.values=[],p.loading=!1,p.noResults=!1,p.focusTypeahead=!1,p.preInitValue=null,p.disabled=p.disabled||!1,p.onSelectValue=v,p.formatLabel=s,p.setFocus=f,p.cleanTypeahead=d,p.filterValues=r,p.key=p.key||"key",p.value=p.value||"value",o()}angular.module("dyn.typeahead").directive("dynTypeahead",e),e.$inject=[],n.$inject=["$http","$timeout","dynDomainsService","$scope"]}();